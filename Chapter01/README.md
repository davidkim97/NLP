# Chapter 01. 처음 만나는 자연어 처리

### 1-1 딥러닝 기반 자연어 처리 모델

- 기계의 자연어 처리

    - 모델 : 입력을 받아 어떤 처리를 수행하는 함수

    - 확률 : 어떤 사건이 나타날 가능성을 의미하는 수치 0, 1 사이의 값으로 표현

    - 모델은 어떤 입력을 받아서 해당 입력이 특정 범주일 확률을 반환하는 확률 함수 이다.

    - 자연어 처리 모델은 자연어를 입력받아서 해당 입력이 특정 범우일 확률을 반환하는 확률 함수.

    - 출력된 확률을 후처리해서 자연어 형태로 변형

- 딥러닝 모델의 학습
    - 레이블을 달아 놓은 학습 데이터가 필요.
        - label : 1은 해당 범주 맞음, 0은 해당 범주가 아님을 뜻함.
    
    - 모델이 데이터의 패턴을 스스로 익히게 학습 과정을 거친다.

    - 학습이란 출력이 정답에 가까워지도록 모델을 업데이트하는 과정을 뜻함.

---
### 1-2 트랜스퍼 러닝

- 트랜스퍼 러닝(transfer learning, 전이 학습) : 특정 태스크를 학습한 모델을 다른 태스크 수행에 재사용하는 기법.
    - 기존보다 모델의 학습 속도가 빨라지고 새로운 태스크를 더 잘 수행하는 경향이 있다.

    - BERT, GPT등도 트랜스퍼 러닝이 적용됨.

    ![tranfer learning](/img/transfer%20learning.PNG)

    - 그림에서 Task1은 업스트림(upstream)태스크라 부르고 Task2는 다운스트림(downstream)이라 부른다.

    - 업스트림 탯크를 학습하는 과정을 프리트레인(pretrain)이라 부른다.

- 업스트림 태스크

    - 대표적인 업스트림 태스크 중 하나는 다음 단어 맞추기이다.
        - ex) 티끌 모아라는 문맥이 주어지고 학습 데이터 말뭉치에 티끌 모아 태산 이라는 구가 많다고 하면 모델은 이를 바탕으로 다음에 올 단어를 태산으로 분류 한다.
    
    - 다음 단어 맞히기로 업스트림 태스크를 수행한 모델을 언어 모델(language model)이라고 한다.
    - 빈칸 채우기로 업스트림 태스크를 수행한 모델을 마스크 언어 모델(masked language model)이라고 한다.
    - 데이터 내에서 정답을 만들고 이를 바탕으로 모델을 학습하는 방법을 자기지도 학습(self-supervised learning)이라고 한다.

- 다운스트림 태스크
    - 다운스트림의 본질은 분류(classification)이다.
    - 자연어를 입력받아 해당 입력이 어떤 범주에 해당하는지 확률 형태로 반환한다.
    - <span style="color:tomato; font-weight:bold">다운스트림 태스크는 자연어 처리의 구체적인 과제들이다.</span>
    - 다운스트림 태스크의 학습 방식에는 파인튜닝(fine-tuning)이 있다.
        - 파인튜닝은 프리트레인을 마친 모델을 다운스트림 태스크에 맞게 업데이트하는 기법.

- 문서분류
    - 문서 분류 모델은 자연어를 입력받아 해당 입력이 어떤 범주에 속하는지 그 확률값을 반환한다.
    - 프리트레인을 마친 마스크 언어 모델위에 작은 모듈을 하나 더 쌓아 문서 전체의 범주를 분류한다.

- 자연어 추론
    - 문장 2개를 입력받아 두 문장 사이의 관계가 참(entailment), 거짓(contradiction), 중립(neutral)등 어떤 범주인지 확률값을 반환한다.

- 개체명 인식
    - 자연어를 입력받아 단어별로 기관명, 인명, 지명 등 어떤 개체명 범주에 속하는지 그 확률값을 반환한다.

- 질의 응답
    - 자연어(질문+지문)를 입력받아 각 단어가 정답의 시작일 확률값과 끝일 확률값을 반환.


- 문장 생성
    - GPT개열 언어 모델이 널리 쓰인다.
    - 자연어(문장)를 입력받아 어휘 전체에 대한 확률값을 반환한다.
    - 확률값은 입력된 문장 다음에 올 단어로 얼마나 적절한지를 나타내는 점수이다.

---
#### 1-3 학습 파이프라인 소개

- 각종 설정값 정하기
    - 모델을 만드려면 가장 먼저 각종 설정값을 정해야한다.
    - 어떤 프리트레인 모델을 사용할지, 학습에 사용할 데이터는 무엇인지, 학습 결과는 어디에 저장할지 등.
    - 하이퍼파라미터(hyperparameter) 역시 미리 정해야 하는 중요한 정보이다.
        - 하이퍼파라미터 : 모델 구조와 학습 등에 직접 관계된 설정값을 가리킴.
        - ex) 러닝 레이트(learning rate), 배치 크기(batch size)등이 있음.